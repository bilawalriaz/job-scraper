{% extends "base.html" %}

{% block title %}Jobs - Job Scraper{% endblock %}

{% block content %}
<div class="d-flex justify-between align-center" style="margin-bottom: 32px;">
    <div>
        <h1 style="font-size: 2rem; font-weight: 800; letter-spacing: -0.03em;">Jobs</h1>
        <p class="text-muted" style="margin-top: 4px;">Browse and manage your job listings</p>
    </div>
</div>

<!-- Filters -->
<div class="card" style="margin-bottom: 24px;">
    <div style="padding: 20px 24px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 16px; align-items: end;">
            <div>
                <label class="form-label">Search</label>
                <input type="text" class="form-control" name="search" placeholder="Search jobs..."
                       hx-get="/htmx/jobs" hx-trigger="keyup changed delay:300ms" hx-target="#jobs-table">
            </div>
            <div>
                <label class="form-label">Status</label>
                <select class="form-select" name="status"
                        hx-get="/htmx/jobs" hx-trigger="change" hx-target="#jobs-table">
                    <option value="">All Status</option>
                    <option value="new" {{ 'selected' if filters.status == 'new' else '' }}>New</option>
                    <option value="interested" {{ 'selected' if filters.status == 'interested' else '' }}>Interested</option>
                    <option value="applied" {{ 'selected' if filters.status == 'applied' else '' }}>Applied</option>
                    <option value="interviewing" {{ 'selected' if filters.status == 'interviewing' else '' }}>Interviewing</option>
                    <option value="offer" {{ 'selected' if filters.status == 'offer' else '' }}>Offer</option>
                    <option value="rejected" {{ 'selected' if filters.status == 'rejected' else '' }}>Rejected</option>
                    <option value="archived" {{ 'selected' if filters.status == 'archived' else '' }}>Archived</option>
                </select>
            </div>
            <div>
                <label class="form-label">Employment Type</label>
                <select class="form-select" name="employment_type"
                        hx-get="/htmx/jobs" hx-trigger="change" hx-target="#jobs-table">
                    <option value="">All Types</option>
                    <option value="contract" {{ 'selected' if filters.employment_type == 'contract' else '' }}>Contract</option>
                    <option value="permanent" {{ 'selected' if filters.employment_type == 'permanent' else '' }}>Permanent</option>
                    <option value="WHF" {{ 'selected' if filters.employment_type == 'WHF' else '' }}>Work From Home</option>
                </select>
            </div>
            <div>
                <label class="form-label">Source</label>
                <select class="form-select" name="source"
                        hx-get="/htmx/jobs" hx-trigger="change" hx-target="#jobs-table">
                    <option value="">All Sources</option>
                    <option value="totaljobs" {{ 'selected' if filters.source == 'totaljobs' else '' }}>TotalJobs</option>
                </select>
            </div>
            <div>
                <div class="text-muted small" style="padding-bottom: 2px;">Showing {{ jobs|length }} of {{ total }} jobs</div>
            </div>
        </div>
    </div>
</div>

<!-- Jobs Table -->
<div class="card">
    <div id="jobs-table" hx-get="/htmx/jobs" hx-trigger="load">
        <div class="htmx-indicator" style="text-align: center; padding: 40px;">
            <div class="spinner" style="width: 40px; height: 40px;"></div>
        </div>
    </div>
</div>

<!-- Pagination -->
<div id="jobs-pagination" style="margin-top: 24px;"></div>

<script>
// Initial load
htmx.trigger('#jobs-table', 'load');
</script>
{% endblock %}
